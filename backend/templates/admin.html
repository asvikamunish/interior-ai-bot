<!DOCTYPE html>
<html>
<head>
  <title>Interior AI Admin Dashboard</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .session { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
    .chat { margin-left: 20px; }
    button { margin-top: 5px; }
  </style>
</head>
<body>

<h1>Admin Dashboard</h1>

<div id="sessions"></div>

<script>
async function loadSessions() {
  const res = await fetch("/admin/sessions");
  const sessions = await res.json();

  const container = document.getElementById("sessions");
  container.innerHTML = "";

  for (const sessionId in sessions) {
    const s = sessions[sessionId];

    const div = document.createElement("div");
    div.className = "session";

    div.innerHTML = `
      <strong>Session:</strong> ${sessionId}<br>
      <strong>Context:</strong> ${JSON.stringify(s.context)}<br>
      <strong>Last Active:</strong> ${s.last_active}<br>
      <strong>Total Messages:</strong> ${s.total_messages}<br>
      <button onclick="loadChat('${sessionId}')">View Chat</button>
      <div id="chat-${sessionId}" class="chat"></div>
    `;

    container.appendChild(div);
  }
}

async function loadChat(sessionId) {
  const res = await fetch(`/admin/session/${sessionId}`);
  const data = await res.json();

  const chatDiv = document.getElementById(`chat-${sessionId}`);
  chatDiv.innerHTML = "";

  data.messages.forEach(m => {
    const p = document.createElement("p");
    p.innerText = `${m.role}: ${m.content}`;
    chatDiv.appendChild(p);
  });
}

loadSessions();
</script>

</body>
</html>
